## 繰り返し文

ここで、`count = count + 1;`と`Serial.print(count);`の二行が繰り返し
出てくることに気づくと思う。例えば、この1から3を表示するプログラムを
1から10だったり1から100まで表示させたいとしたらと考えると、
これを何度も何度も書くのはいくらなんでも嫌すぎる。

そこで繰り返し文の登場だ。1から10を表示するプログラムの例を見てみよう。

```cpp
void setup() {
  Serial.begin(9600);
  int count = 0;
  while (count < 10) {
    count = count + 1;
    Serial.print(count);
  }
}
void loop() {
}
```

繰り返し書かれていた二行が`while (count < 10) {`と`}`に挟まれていることに注意
してほしい。これを実行すると次の出力が得れられる。

```
1
2
3
4
5
6
7
8
9
10
```

`while (count < 10)`の後の`{}`に囲まれた部分が繰り返し実行されているようだ。
**`{}`というのはコードの塊を表しているということ**を覚えておこう。
例えば`setup`の中身は、1行目から8行目までだということを`{}`が示している。
同様に、`while (count < 10)`の中身は4行目の`{`から7行目の`}`までだ。

`{}`の意味を把握できたところで`while (count < 10)`の部分に注目しよう。
`count < 10`が何を意味しているか、そして`while`文がどういうときに繰り返すか
想像がつくかもしれない。試しに`count < 10`を`count < 11`に変えて実行してみよう。

```
1
2
3
4
5
6
7
8
9
10
11
```

こんな出力を得られたはずだ。`while`文は**繰り返し文**と呼ばれるもので、
その名の通り命令を繰り返す役割がある。正確に言うと
**`while`文は`()`内の条件が成り立っている限り`{}`内のコードを繰り返し実行する構文**だ。
上のコード例の処理を追ってみよう。まず、`Serial.begin`でシリアル通信の
準備を整えた後、`count`という名前の`int`型の変数を`0`で初期化している。
ここまでは既に学んでいるものしか出てきていない。
次の行の`while (count < 10)`が出てきたとき`()`の中の条件、
つまり、`count`の中身が`10`より小さいかどうかが検証される。
先ほど`0`に初期化されているため`0 < 10`で条件は当然満たされているため
`{}`の中のコードが実行され、再び`count < 10`かどうか検証される。
これが10回ほど繰り返されると、`count`の中身が`10`になる。

この`count < 10`という条件文に注目してみよう。
今回の例だと`<`が出てきたが他には大なりを意味する`>`や
小なりイコールを意味する`<=`、大なりイコールを意味する`>=`、
そしてノットイコールを意味する`!=`やイコールを意味する`==`などが使える。
これらはすべて「正しい」か「間違っている」かのどちらかになるが、
こういったデータを扱う型`bool`が存在し、正しい場合（真）は`true`、
間違っている場合（偽）は`false`という値をとる。
次のようなコードを考えてみよう。

```cpp
void setup() {
  Serial.begin(9600);
  bool test = true;
  while (test) {
    Serial.print("Infinite loop!\n");
    delay(100);
  }
}
void loop() {
}
```

`while`文の条件部にbool型の変数`test`を渡しているのがわかる。
そして、変数`test`の中身は`true`が入っているため条件は必ず成立している
ことになる。したがって、無限ループが発生する。
もちろん、変数を使うことができる場所には定数も計算式も使うことができるから、
変数を使わず`while (true)`としてもいいし、`while (3 > 2)`のように
書くこともできる。ただし、無限ループはそれで結構だが、一つ問題がある。
コンピュータより性能は下とはいえ、マイコンはかなりの速さで動いているため、
無限ループでそのまま画面に文字を出力してしまうとすごい速さで
流れていってしまう。そこで、`delay`関数の登場だ。`delay`に整数値を渡すと、
渡した整数値分のミリ秒処理を止めてくれる。
コード例の場合は`100`を渡しているから`Serial.print("Infinite loop!\n");`の実行
の間に100ミリ秒の遅延が挟まる。

しかし、無限ループを`while (true)`で実現する必要は実はない。
`void setup()`の中身の実行が終わった後は、これまでスルーしてきた
`void loop()`の中身が繰り返し実行されるようになっている。
マイコンプログラムはよく最後に繰り返し実行する処理を`while (true)`のように
無限ループで実現するが、Arduinoの場合はそれは`void loop()`に織り込まれている、
というわけだ。つまり、先ほどのコードは次のように書き直すことができる。

```cpp
void setup() {
  Serial.begin(9600);
}
void loop() {
  Serial.print("Infinite loop!\n");
  delay(100);
}
```

